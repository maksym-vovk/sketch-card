{"version":3,"file":"subscribe.js","sources":["../../src/js/modules/LanguageSwitcher.js","../../src/js/modules/ThankYouPageManager.js","../../src/js/subscribe.js"],"sourcesContent":["const SELECTORS = {\r\n    CUSTOM: '.lang-switcher__custom',\r\n    SELECTED: '.lang-switcher__selected',\r\n    TEXT: '.lang-switcher__text',\r\n    OPTIONS: '.lang-switcher__option'\r\n};\r\n\r\nconst CSS_CLASSES = {\r\n    ACTIVE: 'active',\r\n    SELECTED: 'selected'\r\n};\r\n\r\nconst STORAGE_KEY = 'language';\r\nconst SUBSCRIBE_PAGE = 'subscribe.html';\r\n\r\nconst COUNTRY_MAP = {\r\n    HR: 'hr',\r\n    SI: 'sl'\r\n};\r\n\r\nconst LANGUAGE_MAP = {\r\n    hr: 'hr',\r\n    sl: 'sl'\r\n};\r\n\r\nconst API_URL = 'https://ipapi.co/json/';\r\n\r\nexport const LanguageSwitcher = {\r\n    async detectUserLanguage() {\r\n        try {\r\n            const controller = new AbortController();\r\n            setTimeout(() => controller.abort(), 500);\r\n\r\n            const response = await fetch(API_URL);\r\n            const data = await response.json();\r\n            return COUNTRY_MAP[data.country_code] || '';\r\n        } catch (error) {\r\n            console.warn('Failed to detect language from IP:', error);\r\n            const browserLang = navigator.language.split('-')[0];\r\n            return LANGUAGE_MAP[browserLang] || '';\r\n        }\r\n    },\r\n\r\n    async getLanguage() {\r\n        let savedLang = localStorage.getItem(STORAGE_KEY);\r\n\r\n        if (savedLang === null) {\r\n            savedLang = await this.detectUserLanguage();\r\n            localStorage.setItem(STORAGE_KEY, savedLang);\r\n        }\r\n\r\n        return savedLang;\r\n    },\r\n\r\n    redirectIfNeeded(savedLang) {\r\n        const currentPath = window.location.pathname;\r\n        const isSubscribePage = currentPath.includes(SUBSCRIBE_PAGE);\r\n        const queryParams = window.location.search;\r\n\r\n        if (savedLang && !currentPath.includes(`/${savedLang}/`)) {\r\n            window.location.href = isSubscribePage\r\n                ? `/${savedLang}/${SUBSCRIBE_PAGE}${queryParams}`\r\n                : `/${savedLang}/${queryParams}`;\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    toggleDropdown(custom) {\r\n        custom.classList.toggle(CSS_CLASSES.ACTIVE);\r\n    },\r\n\r\n    closeDropdown(custom) {\r\n        custom.classList.remove(CSS_CLASSES.ACTIVE);\r\n    },\r\n\r\n    setSelectedLanguage(text, options, currentLang) {\r\n        const currentOption = Array.from(options).find(opt => opt.dataset.code === currentLang);\r\n        text.textContent = currentOption?.textContent || 'EN';\r\n        currentOption?.classList.add(CSS_CLASSES.SELECTED);\r\n    },\r\n\r\n    handleOptionClick(option, text, options, custom) {\r\n        const value = option.dataset.value;\r\n        const code = option.dataset.code;\r\n        const queryParams = window.location.search;\r\n\r\n        text.textContent = option.textContent;\r\n        options.forEach(opt => opt.classList.remove(CSS_CLASSES.SELECTED));\r\n        option.classList.add(CSS_CLASSES.SELECTED);\r\n        this.closeDropdown(custom);\r\n\r\n        localStorage.setItem(STORAGE_KEY, code === 'en' ? '' : code);\r\n        window.location.href = value + queryParams;\r\n    },\r\n\r\n    // bug fix. EN - HR\r\n    bindCustomSelect() {\r\n        const custom = document.querySelector(SELECTORS.CUSTOM);\r\n        const selected = document.querySelector(SELECTORS.SELECTED);\r\n        const text = document.querySelector(SELECTORS.TEXT);\r\n        const options = document.querySelectorAll(SELECTORS.OPTIONS);\r\n\r\n        if (!custom || !selected) {\r\n            console.warn('No language switcher found');\r\n            return;\r\n        }\r\n\r\n        const currentLang = localStorage.getItem(STORAGE_KEY) || 'en';\r\n        this.setSelectedLanguage(text, options, currentLang);\r\n\r\n        selected.addEventListener('click', (e) => {\r\n            e.stopPropagation();\r\n            this.toggleDropdown(custom);\r\n        });\r\n\r\n        options.forEach(option => {\r\n            option.addEventListener('click', () => {\r\n                this.handleOptionClick(option, text, options, custom);\r\n            });\r\n        });\r\n\r\n        document.addEventListener('click', () => {\r\n            this.closeDropdown(custom);\r\n        });\r\n    },\r\n\r\n    async init() {\r\n        try {\r\n            const savedLang = await this.getLanguage();\r\n            const redirected = this.redirectIfNeeded(savedLang);\r\n\r\n            if (!redirected) {\r\n                this.bindCustomSelect();\r\n            }\r\n        } catch (error) {\r\n            console.error('LanguageSwitcher initialization failed:', error);\r\n            this.bindCustomSelect();\r\n        }\r\n    }\r\n};","const SELECTORS = {\r\n    CALL_TEXT: '.thank-you__text--callback',\r\n    ORDER_TEXT: '.thank-you__text--order',\r\n};\r\n\r\nconst CSS_CLASSES = {\r\n    HIDDEN: 'hidden',\r\n};\r\n\r\nexport const ThankYouPageManager = {\r\n    setCongratulationText() {\r\n        const queryParams = new URLSearchParams(window.location.search);\r\n        const redirectType = queryParams.get('redirect');\r\n\r\n        const callText = document.querySelector(SELECTORS.CALL_TEXT);\r\n        const orderText = document.querySelector(SELECTORS.ORDER_TEXT);\r\n\r\n        if (!callText || !orderText) {\r\n            console.warn('Congratulation text elements not found');\r\n            return;\r\n        }\r\n\r\n        switch (redirectType) {\r\n            case 'call_request':\r\n                callText.classList.remove(CSS_CLASSES.HIDDEN);\r\n                orderText.classList.add(CSS_CLASSES.HIDDEN);\r\n                break;\r\n            case 'order':\r\n                orderText.classList.remove(CSS_CLASSES.HIDDEN);\r\n                callText.classList.add(CSS_CLASSES.HIDDEN);\r\n                break;\r\n            default:\r\n                console.warn('Unknown redirect type, showing default text');\r\n        }\r\n    },\r\n\r\n    init() {\r\n        this.setCongratulationText();\r\n    }\r\n};\r\n","import {LanguageSwitcher} from \"./modules/LanguageSwitcher\";\r\nimport {ThankYouPageManager} from \"./modules/ThankYouPageManager\";\r\n\r\nfunction main() {\r\n    LanguageSwitcher.init()\r\n    ThankYouPageManager.init()\r\n}\r\n\r\nmain();\r\n\r\n// if (document.documentElement.clientWidth < 480) {\r\n//     window.addEventListener('scroll',\r\n//         function () {\r\n//             return setTimeout(main, 1000);\r\n//         }, {\r\n//             once: true\r\n//         });\r\n// } else {\r\n//     main();\r\n// }\r\n"],"names":["SELECTORS","CUSTOM","SELECTED","TEXT","OPTIONS","CSS_CLASSES","ACTIVE","STORAGE_KEY","SUBSCRIBE_PAGE","COUNTRY_MAP","HR","SI","LANGUAGE_MAP","hr","sl","API_URL","LanguageSwitcher","detectUserLanguage","controller","AbortController","setTimeout","abort","response","fetch","data","json","country_code","error","console","warn","browserLang","navigator","language","split","getLanguage","savedLang","localStorage","getItem","setItem","redirectIfNeeded","currentPath","window","location","pathname","isSubscribePage","includes","queryParams","search","href","toggleDropdown","custom","classList","toggle","closeDropdown","remove","setSelectedLanguage","text","options","currentLang","currentOption","Array","from","find","opt","dataset","code","textContent","add","handleOptionClick","option","value","forEach","bindCustomSelect","document","querySelector","selected","querySelectorAll","addEventListener","e","stopPropagation","init","redirected","CALL_TEXT","ORDER_TEXT","HIDDEN","ThankYouPageManager","setCongratulationText","URLSearchParams","redirectType","get","callText","orderText","main"],"mappings":"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"}