{"version":3,"file":"subscribe.js","sources":["../../src/js/modules/LanguageSwitcher.js","../../src/js/subscribe.js"],"sourcesContent":["const SELECTORS = {\n    CUSTOM: '.lang-switcher__custom',\n    SELECTED: '.lang-switcher__selected',\n    TEXT: '.lang-switcher__text',\n    OPTIONS: '.lang-switcher__option'\n};\n\nconst CSS_CLASSES = {\n    ACTIVE: 'active',\n    SELECTED: 'selected'\n};\n\nconst STORAGE_KEY = 'language';\nconst SUBSCRIBE_PAGE = 'subscribe.html';\n\nconst COUNTRY_MAP = {\n    HR: 'hr',\n    SI: 'sl'\n};\n\nconst LANGUAGE_MAP = {\n    hr: 'hr',\n    sl: 'sl'\n};\n\nconst API_URL = 'https://ipapi.co/json/';\n\nexport const LanguageSwitcher = {\n    async detectUserLanguage() {\n        try {\n            const response = await fetch(API_URL);\n            const data = await response.json();\n            const countryCode = data.country_code;\n\n            return COUNTRY_MAP[countryCode] || '';\n        } catch (error) {\n            console.warn('Failed to detect language from IP:', error);\n            const browserLang = navigator.language.split('-')[0];\n            return LANGUAGE_MAP[browserLang] || '';\n        }\n    },\n\n    async getLanguage() {\n        let savedLang = localStorage.getItem(STORAGE_KEY);\n\n        if (savedLang === null) {\n            savedLang = await this.detectUserLanguage();\n            localStorage.setItem(STORAGE_KEY, savedLang);\n        }\n\n        return savedLang;\n    },\n\n    redirectIfNeeded(savedLang) {\n        const currentPath = window.location.pathname;\n        const isSubscribePage = currentPath.includes(SUBSCRIBE_PAGE);\n\n        if (savedLang && !currentPath.includes(`/${savedLang}/`)) {\n            window.location.href = isSubscribePage\n                ? `/${savedLang}/${SUBSCRIBE_PAGE}`\n                : `/${savedLang}/`;\n            return true;\n        }\n\n        return false;\n    },\n\n    toggleDropdown(custom) {\n        custom.classList.toggle(CSS_CLASSES.ACTIVE);\n    },\n\n    closeDropdown(custom) {\n        custom.classList.remove(CSS_CLASSES.ACTIVE);\n    },\n\n    setSelectedLanguage(text, options, currentLang) {\n        const currentOption = Array.from(options).find(opt => opt.dataset.code === currentLang);\n        text.textContent = currentOption?.textContent || 'EN';\n        currentOption?.classList.add(CSS_CLASSES.SELECTED);\n    },\n\n    handleOptionClick(option, text, options, custom) {\n        const value = option.dataset.value;\n        const code = option.dataset.code;\n\n        text.textContent = option.textContent;\n        options.forEach(opt => opt.classList.remove(CSS_CLASSES.SELECTED));\n        option.classList.add(CSS_CLASSES.SELECTED);\n        this.closeDropdown(custom);\n\n        localStorage.setItem(STORAGE_KEY, code === 'en' ? '' : code);\n        window.location.href = value;\n    },\n\n    bindCustomSelect() {\n        const custom = document.querySelector(SELECTORS.CUSTOM);\n        const selected = document.querySelector(SELECTORS.SELECTED);\n        const text = document.querySelector(SELECTORS.TEXT);\n        const options = document.querySelectorAll(SELECTORS.OPTIONS);\n\n        if (!custom || !selected) {\n            console.warn('No language switcher found');\n            return;\n        }\n\n        const currentLang = localStorage.getItem(STORAGE_KEY) || 'en';\n        this.setSelectedLanguage(text, options, currentLang);\n\n        selected.addEventListener('click', (e) => {\n            e.stopPropagation();\n            this.toggleDropdown(custom);\n        });\n\n        options.forEach(option => {\n            option.addEventListener('click', () => {\n                this.handleOptionClick(option, text, options, custom);\n            });\n        });\n\n        document.addEventListener('click', () => {\n            this.closeDropdown(custom);\n        });\n    },\n\n    async init() {\n        try {\n            const savedLang = await this.getLanguage();\n            const redirected = this.redirectIfNeeded(savedLang);\n\n            if (!redirected) {\n                this.bindCustomSelect();\n            }\n        } catch (error) {\n            console.error('LanguageSwitcher initialization failed:', error);\n            this.bindCustomSelect();\n        }\n    }\n};","import {LanguageSwitcher} from \"./modules/LanguageSwitcher\";\n\nfunction main() {\n    LanguageSwitcher.init()\n}\n\nif (document.documentElement.clientWidth < 480) {\n    window.addEventListener('scroll',\n        function () {\n            return setTimeout(main, 1000);\n        }, {\n            once: true\n        });\n} else {\n    main();\n}\n"],"names":["SELECTORS","CUSTOM","SELECTED","TEXT","OPTIONS","CSS_CLASSES","ACTIVE","STORAGE_KEY","SUBSCRIBE_PAGE","COUNTRY_MAP","HR","SI","LANGUAGE_MAP","hr","sl","API_URL","LanguageSwitcher","detectUserLanguage","response","fetch","data","json","countryCode","country_code","error","console","warn","browserLang","navigator","language","split","getLanguage","savedLang","localStorage","getItem","setItem","redirectIfNeeded","currentPath","window","location","pathname","isSubscribePage","includes","href","toggleDropdown","custom","classList","toggle","closeDropdown","remove","setSelectedLanguage","text","options","currentLang","currentOption","Array","from","find","opt","dataset","code","textContent","add","handleOptionClick","option","value","forEach","bindCustomSelect","document","querySelector","selected","querySelectorAll","addEventListener","e","stopPropagation","init","redirected","main","documentElement","clientWidth","setTimeout","once"],"mappings":"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"}